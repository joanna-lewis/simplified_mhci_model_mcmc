timepoints = [0.5, 1:8];

tryptic_data = csvread('B8_tryptic.csv',1,1);
Kb_data = csvread('B8_Db.csv',1,1);

options.burnin = 100;
options.samples = 100;
options.start = [1.4098e+02, ...
                1.4801, ...
                5.0450e-01, ...
                6.74, ...
                5.9327e+01, ...
                0.5, 500 ...
                ];
            
options.stepSize = [0.05*1.4098e+02, ...
                0.05*1.4801, ...
                0.05*5.0450e-01, ...
                0.05*6.74, ...
                0.05*5.9327e+01, ...
                0.05, 500 ...
                ];
            
% options.parsToInfer

solstart = simplified_model([1.4098e+02, ...
                1.4801, ...
                5.0450e-01, ...
                1e4, ...
                1, ...
                6.74, ...
                5.9327e+01 ...
                ], ...
            0:0.1:max(timepoints));

figure(1)
plot(0:0.1:max(timepoints), solstart(1,:), 'r');
hold on
plot(timepoints, tryptic_data, 'o')

figure(2)
plot(0:0.1:max(timepoints), solstart(2,:), 'r');
hold on
plot(timepoints, Kb_data, 'o')
            


gibbs_sampler(timepoints, tryptic_data, Kb_data, options)